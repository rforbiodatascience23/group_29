"0","#| label: 03-05"
"0",""
"0","# Create broader groupings for pathologic stages, considering clinical_stage if pathologic_stage is not usable"
"0","# Create a function to map stages"
"0","map_stage <- function(pathologic_stage, clinical_stage) {"
"0","  if (pathologic_stage %in% c(""Stage I"", ""Stage IA"", ""Stage IB"", ""IS"", ""I/II NOS"")) {"
"0","    return(""Stage 1"")"
"0","  } else if (pathologic_stage %in% c(""Stage II"", ""Stage IIA"", ""Stage IIB"", ""Stage IIC"")) {"
"0","    return(""Stage 2"")"
"0","  } else if (pathologic_stage %in% c(""Stage III"", ""Stage IIIA"", ""Stage IIIB"", ""Stage IIIC"")) {"
"0","    return(""Stage 3"")"
"0","  } else if (pathologic_stage %in% c(""Stage IV"", ""Stage IVA"", ""Stage IVB"", ""Stage IVC"")) {"
"0","    return(""Stage 4"")"
"0","  } else if (pathologic_stage %in% c(""[Discrepancy]"", ""[Not Applicable]"", ""[Not Available]"", ""[Unknown]"")) {"
"0","    if (clinical_stage %in% c(""I"",""Stage I"", ""Stage IA"", ""Stage IA1"", ""Stage IA2"", ""Stage IB"", ""Stage IB1"", ""Stage IB2"", ""Stage IC"")) {"
"0","      return(""Stage 1"")"
"0","    } else if (clinical_stage %in% c(""Stage II"", ""Stage IIA"", ""Stage IIA1"", ""Stage IIA2"", ""Stage IIB"", ""Stage IIC"")) {"
"0","      return(""Stage 2"")"
"0","    } else if (clinical_stage %in% c(""III"", ""IIIA"", ""IIIB"", ""IIIC"", ""IIIC1"", ""IIIC2"")) {"
"0","      return(""Stage 3"")"
"0","    } else if (clinical_stage %in% c(""IV"", ""IVA"", ""IVB"", ""IVC"")) {"
"0","      return(""Stage 4"")"
"0","    } "
"0","  }"
"0","  # If none of the conditions match, return the original pathologic_stage"
"0","  return(""other"")"
"0","}"
"0",""
"0","# Apply the mapping function to create the stage_group variable"
"0","TCGA_aug <- TCGA_aug |> "
"0","  mutate(stage_group = map2_chr(pathologic_stage, clinical_stage, map_stage))"
